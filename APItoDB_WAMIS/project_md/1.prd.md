 prd.md


    1 # 제품 요구사항 문서 (PRD)
    2
    3 ## 1. 개요
    4
    5 본 문서는 WAMIS (Water Management Information System) API 및 한국농어촌공사(KRC) 농업용수관리자동화시스템(RIMS) API를 통해 수자원
      및 농업용 저수지 관련 데이터를 수집하고, 이를 PostgreSQL 데이터베이스에 저장하는
      '데이터 수집기' 애플리케이션의 요구사항을 정의합니다.
    6
    7 ## 2. 주요 기능
    8
    9 ### 2.1. 데이터 수집
   10
   11 - **API 연동:**
   12     - WAMIS에서 제공하는 Open API (JSON 형식)
   13     - KRC 농업용 저수지 정보 Open API (XML 형식)
   14 - **데이터 종류 (WAMIS):**
   15     - 강수량 (시간별, 일별, 월별)
   16     - 수위 (시간별, 일별)
   17     - 기상 정보 (시간별, 일별)
   18     - 유량 (일별 및 유량 측정 정보)
   19 - **데이터 종류 (KRC):**
   20     - 농업용 저수지 코드 정보 (저수지 코드, 저수지명, 시군명 등)
   21     - 농업용 저수지 일별 수위 및 저수율 정보
   22 - **수집 주기 (WAMIS):**
   23     - **초기 데이터 로드:** 사용자가 지정한 기간 동안의 전체 WAMIS 데이터를 일괄적으로 수집합니다.
   24     - **일일 동기화:** 매일 자동으로 최신 WAMIS 데이터를 수집하여 데이터베이스를 업데이트합니다.
   25     - **최근 7일 데이터 최신화:** 매일 또는 필요시 최근 7일간의 WAMIS 데이터를 다시 수집하여 데이터베이스를 최신 상태로 업데이트합니다.
   26 - **수집 주기 (KRC):**
   27     - **저수지 코드 전체 조회/저장:** 사용자가 수동으로 실행하여 전체 KRC 저수지 코드 정보를 DB에 저장/업데이트합니다. (수위 데이터 수집 전 선행 작업)
   28     - **초기 수위 데이터 로드:** 사용자가 지정한 기간 동안 DB에 저장된 모든 KRC 저수지에 대해 수위 데이터를 일괄 수집합니다. (API 제약에 따라 기간 분할 처리)
   29     - **수위 데이터 일별 최신화:** DB에 저장된 각 KRC 저수지의 마지막 데이터 저장일 다음날부터 현재까지의 수위 데이터를 수집하여 업데이트합니다.
   30     - **수위 데이터 누락 보충:** 사용자가 지정한 기간 동안 DB에 저장된 모든 KRC 저수지에 대해 수위 데이터를 재수집하여 누락분을 보충합니다. (API 제약에 따라 기간 분할 처리)
   31
   32 ### 2.2. 데이터 저장
   33
   34 - **데이터베이스:** 수집된 모든 데이터는 PostgreSQL 데이터베이스에 저장됩니다.
   35 - **테이블 구조:**
   36     - WAMIS 데이터: 각 데이터 종류 및 주기에 따라 별도의 테이블에 저장 (예: `rf_hourly`, `wl_daily` 등)
   37     - KRC 데이터:
   38         - `stations` 테이블: KRC 저수지 코드 및 이름 저장 (`station_type`으로 "KRC_RESERVOIR" 지정)
   39         - `krc_reservoir_daily` 테이블: KRC 저수지 일별 수위 및 저수율 데이터 저장
   40 - **데이터 무결성:** 관측소/저수지 코드와 관측 시간을 기본 키(Primary Key)로 사용하여 데이터 중복을 방지합니다.
   41
   42 ### 2.3. 사용자 인터페이스 (UI)
   43
   44 - **직관적인 UI:** 사용자가 쉽게 WAMIS 및 KRC 데이터 수집을 시작하고 진행 상황을 모니터링할 수 있는 Windows Forms 기반의 GUI를 제공합니다.
   45 - **기능 버튼:**
   46     - WAMIS 데이터용: "초기 데이터 로드", "일별 최신화", "누락 데이터 보충" 버튼 제공.
   47     - KRC 데이터용: "전체 코드 조회/저장", "초기 수위 로드", "수위 일별 최신화", "수위 누락 보충" 버튼 제공.
   48 - **로그 표시:** 데이터 수집 과정 및 결과를 실시간으로 확인할 수 있는 로그 창을 제공합니다.
   49 - **테스트 모드:** WAMIS 및 KRC 데이터 수집 시 테스트를 위한 옵션을 제공합니다.
   50 - **진행률 표시:** 데이터 수집 작업 시 진행률을 표시하는 프로그레스 바를 제공합니다.
   51
   52 ### 2.4. 설정 관리
   53
   54 - **외부 설정 파일:** API 키(WAMIS용, KRC용), API 기본 URL(WAMIS용), 데이터베이스 연결 문자열 등 주요 설정은 `App.config` 파일을 통해 관리합니다.
   55
   56 ## 3. 비기능적 요구사항
   39
   40 - **안정성:** 장기간 데이터 수집 작업에도 안정적으로 동작해야 합니다.
   41 - **오류 처리:** API 요청 실패, 데이터베이스 연결 오류 등 다양한 예외
      상황에 대한 적절한 오류 처리 및 로깅 기능을 갖추어야 합니다.
   42 - **확장성:** 향후 새로운 데이터 종류나 API가 추가될 경우, 쉽게 확장할 수
      있는 구조로 설계되어야 합니다.
   43
   44 ## 4. 향후 개선 사항
   45
   46 - **데이터 시각화:** 수집된 데이터를 차트나 그래프 형태로 시각화하는 기능
      추가를 고려할 수 있습니다.
   47 - **다양한 데이터베이스 지원:** PostgreSQL 외에 다른 데이터베이스
      시스템(예: MySQL, MS-SQL)을 지원할 수 있도록 데이터 서비스 계층을
      추상화하는 것을 고려할 수 있습니다.
   48 - **웹 기반 대시보드:** 수집 현황 및 통계를 확인할 수 있는 웹 기반 대시보드
      개발을 고려할 수 있습니다.